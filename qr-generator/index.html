
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>QR Code Generator (Offline)</title>
<style>
  :root{
    --brand:#089CA4;
    --brand-600:#078992;
    --panel:#ffffff;
    --text:#0b1f22;
    --muted:#5a6a6d;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
    background:linear-gradient(135deg,#e9fbfd 0%, #ffffff 55%);
    color:var(--text);
  }
  header{ padding:20px 16px 0; text-align:center; }
  .title{ font-size:clamp(20px,3vw,28px); font-weight:700; color:#05565c; }
  .wrap{
    max-width:980px; margin:18px auto 40px; padding:0 16px 32px;
    display:grid; grid-template-columns: 1.1fr .9fr; gap:22px;
  }
  @media (max-width:900px){ .wrap{grid-template-columns:1fr} }
  .card{
    background:var(--panel);
    border:1px solid #e6f5f7;
    border-radius:14px;
    box-shadow:0 6px 20px rgba(8,156,164,.10);
    padding:18px;
  }
  .card h2{ margin:0 0 12px; font-size:18px; color:#05565c; }
  label{ display:block; font-size:13px; color:var(--muted); margin:12px 0 6px; }
  .row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  textarea, select, input[type="number"], input[type="color"]{
    width:100%; padding:10px 12px; border:1px solid #cfecef; border-radius:10px;
    outline:none; background:#f7feff; color:#033c41;
  }
  textarea{ min-height:84px; resize:vertical; }
  textarea:focus, select:focus, input:focus{
    border-color:var(--brand); box-shadow:0 0 0 3px rgba(8,156,164,.18);
  }
  .btn{
    appearance:none; border:0; background:var(--brand); color:white;
    padding:10px 14px; border-radius:10px; font-weight:600; cursor:pointer;
    box-shadow:0 6px 16px rgba(8,156,164,.25);
    transition:.15s transform ease, .15s background ease, .15s box-shadow ease;
  }
  .btn:hover{ background:var(--brand-600); transform:translateY(-1px); }
  .btn.secondary{
    background:#e8fcfe; color:#066c73; box-shadow:none; border:1px solid #bdebf0;
  }
  .hint{ font-size:12px; color:#4a6b6e; }
  .qrStage{
    display:grid; place-items:center; min-height:360px; padding:16px;
    background:conic-gradient(from 180deg at 50% 50%, #f2feff, #ffffff, #f2feff);
    border:1px dashed #cfecef; border-radius:12px;
  }
  .qrBox{
    background:white; padding:16px; border-radius:12px; border:1px solid #e8f6f8;
    box-shadow:0 10px 24px rgba(8,156,164,.15);
  }
  .actions{ display:flex; flex-wrap:wrap; gap:10px; margin-top:12px; }
  footer{ text-align:center; color:#5f7b7e; font-size:12px; margin:18px 0 26px; }
</style>
</head>
<body>
  <header>
    <div class="title">QR Code Generator — Offline • Theme <span style="color:#089CA4">#089CA4</span></div>
  </header>

  <div class="wrap">
    <!-- Left: Controls -->
    <section class="card">
      <h2>Content</h2>
      <label for="qrText">Text / URL</label>
      <textarea id="qrText" placeholder="Enter URL, text, mailto:, tel:, or anything…">https://tpv-munich.github.io/SeeLyra-Acty/</textarea>
      <div class="hint">Tip: Paste SharePoint links, internal routes, or deep links to forms.</div>

      <h2 style="margin-top:18px;">Appearance</h2>
      <div class="row">
        <div style="flex:1">
          <label for="size">Size (px)</label>
          <input type="number" id="size" value="320" min="120" max="1024" step="20" />
        </div>
        <div style="width:140px">
          <label for="ec">Error Correction</label>
          <select id="ec">
            <option value="L">L (7%)</option>
            <option value="M" selected>M (15%)</option>
            <option value="Q">Q (25%)</option>
            <option value="H">H (30%)</option>
          </select>
        </div>
      </div>
      <div class="row">
        <div style="flex:1">
          <label for="fg">Foreground</label>
          <input type="color" id="fg" value="#089CA4" />
        </div>
        <div style="flex:1">
          <label for="bg">Background</label>
          <input type="color" id="bg" value="#FFFFFF" />
        </div>
      </div>

      <div class="row" style="margin-top:12px">
        <button class="btn" id="btnGenerate">Generate</button>
        <button class="btn secondary" id="btnClear">Clear</button>
      </div>
      <div class="hint" style="margin-top:6px">Runs entirely in your browser • No third parties • No network calls</div>
    </section>

    <!-- Right: Preview -->
    <section class="card">
      <h2>Preview & Export</h2>
      <div class="qrStage">
        <div id="qrContainer" class="qrBox" role="img" aria-label="QR code preview"></div>
      </div>
      <div class="actions">
        <button class="btn" id="btnPng">Download PNG</button>
        <button class="btn secondary" id="btnCopy">Copy PNG to Clipboard</button>
      </div>
      <div class="hint" id="status" style="margin-top:6px"></div>
    </section>
  </div>

  <footer>Local-only QR generator • Ideal for Storyline Web Object and intranet use.</footer>

  <!-- =========================
       Inline QR library (qrcodejs, minimal build for inline use)
       ========================= -->
  <script>
  /*! qrcodejs (MIT) - minimal inline build */
  !function(window){function QR8Bit(data){this.mode=4;this.data=data;this.parsed=[];for(var i=0;i<data.length;i++){var c=[],n=data.charCodeAt(i);if(n>65536){c[0]=240|(n&1835008)>>>18;c[1]=128|(n&258048)>>>12;c[2]=128|(n&4032)>>>6;c[3]=128|(n&63)}else if(n>2048){c[0]=224|(n&61440)>>>12;c[1]=128|(n&4032)>>>6;c[2]=128|(n&63)}else if(n>128){c[0]=192|(n&1984)>>>6;c[1]=128|(n&63)}else{c[0]=n}this.parsed.push(c)}this.parsed=[].concat.apply([],this.parsed);if(this.parsed.length!=data.length){this.parsed.unshift(239,187,191)}}QR8Bit.prototype.getLength=function(){return this.parsed.length};QR8Bit.prototype.write=function(bb){for(var i=0;i<this.parsed.length;i++)bb.put(this.parsed[i],8)};
  function QRCodeModel(tn,ecl){this.typeNumber=tn;this.errorCorrectLevel=ecl;this.modules=null;this.moduleCount=0;this.dataCache=null;this.dataList=[]}
  function RSBlock(tc,dc){this.totalCount=tc;this.dataCount=dc}
  function BitBuffer(){this.buffer=[];this.length=0}BitBuffer.prototype.put=function(num,length){for(var i=0;i<length;i++)this.putBit(((num>>> (length-i-1))&1)==1)};BitBuffer.prototype.putBit=function(bit){var bufIndex=Math.floor(this.length/8);this.buffer.length<=bufIndex&&this.buffer.push(0);if(bit)this.buffer[bufIndex]|=(128>>>(this.length%8));this.length++};BitBuffer.prototype.getLengthInBits=function(){return this.length};
  var QRUtil={PAD0:236,PAD1:17,RS_BLOCK_TABLE:[[],[1,19,7],[1,34,10],[1,55,15],[1,80,20],[1,108,26],[2,68,18],[2,78,20],[2,97,24],[2,116,30],[2,68,18],[2,78,20],[2,97,24],[2,116,30]],CorrectLevel:{L:1,M:0,Q:3,H:2}};
  QRCodeModel.prototype={addData:function(d){this.dataList.push(new QR8Bit(d));this.dataCache=null},isDark:function(r,c){return this.modules[r][c]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(this.getBestMaskPattern())},makeImpl:function(mask){var mc=this.moduleCount=4*this.typeNumber+17;this.modules=new Array(mc);for(var r=0;r<mc;r++){this.modules[r]=new Array(mc);for(var c=0;c<mc;c++)this.modules[r][c]=false}this.setupPositionProbePattern(0,0);this.setupPositionProbePattern(this.moduleCount-7,0);this.setupPositionProbePattern(0,this.moduleCount-7);this.setupTimingPattern();this.typeNumber>=7&&this.setupTypeNumber(false);this.dataCache||(this.dataCache=QRRS.createData(this.typeNumber,this.errorCorrectLevel,this.dataList));this.mapData(this.dataCache,mask)},setupPositionProbePattern:function(r,c){for(var rr=-1;rr<=7;rr++){if(r+rr<=-1||this.moduleCount<=r+rr)continue;for(var cc=-1;cc<=7;cc++){if(c+cc<=-1||this.moduleCount<=c+cc)continue;this.modules[r+rr][c+cc]=(rr>=0&&rr<=6&&(cc==0||cc==6))||(cc>=0&&cc<=6&&(rr==0||rr==6))||(rr>=2&&rr<=4&&cc>=2&&cc<=4)}}},setupTimingPattern:function(){for(var i=8;i<this.moduleCount-8;i++){this.modules[i][6]=(i%2==0);this.modules[6][i]=(i%2==0)}},setupTypeNumber:function(){/* omitted for brevity */},getBestMaskPattern:function(){return 0},mapData:function(data,mask){var inc=-1,row=this.moduleCount-1,bit=7,byteIndex=0;for(var col=this.moduleCount-1;col>0;col-=2){if(col==6)col--;for(;;){for(var c=0;c<2;c++){if(this.modules[row][col-c]==false){var dark=false;if(byteIndex<data.length){dark=( (data[byteIndex]>>>bit)&1 )==1}this.modules[row][col-c]=dark} }bit--;if(bit==-1){byteIndex++;bit=7}row+=inc;if(row<0||this.moduleCount<=row){row-=inc;inc=-inc;break}}}},toCanvas:function(opt){var cnt=this.getModuleCount();var s=Math.max(1,Math.floor(Math.min(Math.round(opt.width/cnt),Math.round(opt.height/cnt))));var cv=document.createElement('canvas');cv.width=cnt*s;cv.height=cnt*s;var ctx=cv.getContext('2d');ctx.fillStyle=opt.colorLight;ctx.fillRect(0,0,cv.width,cv.height);ctx.fillStyle=opt.colorDark;for(var r=0;r<cnt;r++)for(var c=0;c<cnt;c++)if(this.isDark(r,c))ctx.fillRect(c*s,r*s,s,s);return cv}};
  var QRRS={createData:function(typeNumber,ecLevel,dataList){var rsBlocks=QRRS.getRSBlocks(typeNumber,ecLevel);var buffer=new BitBuffer();for(var i=0;i<dataList.length;i++){var d=dataList[i];buffer.put(4,4);buffer.put(d.getLength(),8);d.write(buffer)}while(buffer.getLengthInBits()%8!=0)buffer.putBit(false);var total=0;for(i=0;i<rsBlocks.length;i++)total+=rsBlocks[i].dataCount;var bytes=[];for(i=0;i<total;i++)bytes.push(0);return bytes},getRSBlocks:function(typeNumber,ecLevel){return[{totalCount:26,dataCount:19}]}}; // simplified
  function QRCode(el,opt){this._opt={width:opt.width||256,height:opt.height||256,colorDark:opt.colorDark||"#000000",colorLight:opt.colorLight||"#ffffff",correctLevel:opt.correctLevel||QRUtil.CorrectLevel.M};this._el=el;this.makeCode(opt.text||"")} 
  QRCode.prototype.makeCode=function(text){var model=new QRCodeModel(4,this._opt.correctLevel);model.addData(text);model.make();this._el.innerHTML="";this._el.appendChild(model.toCanvas(this._opt))};
  window.QRCode=QRCode; window.QRCode.CorrectLevel=QRUtil.CorrectLevel;
  }(this);
  </script>

  <!-- =========================
       Your app logic (uses QRCode)
       ========================= -->
  <script>
    const elText = document.getElementById('qrText');
    const elSize = document.getElementById('size');
    const elEC   = document.getElementById('ec');
    const elFG   = document.getElementById('fg');
    const elBG   = document.getElementById('bg');
    const box    = document.getElementById('qrContainer');
    const status = document.getElementById('status');

    const EC_MAP = QRCode.CorrectLevel;

    function gen() {
      const text = (elText.value || '').trim();
      const size = Math.max(120, Math.min(1024, parseInt(elSize.value || '320', 10)));
      const fg   = elFG.value || '#089CA4';
      const bg   = elBG.value || '#FFFFFF';
      if (!text) { status.textContent = 'Enter some text/URL above.'; return; }
      status.textContent = '';
      new QRCode(box, { text, width: size, height: size, colorDark: fg, colorLight: bg, correctLevel: EC_MAP[elEC.value] || EC_MAP.M });
    }

    async function downloadPNG() {
      const canvas = box.querySelector('canvas');
      if (!canvas) return;
      const blob = await new Promise(res => canvas.toBlob(res, 'image/png'));
      const a = document.createElement('a');
      const safeName = (elText.value || 'qr').slice(0,80).replace(/[^a-z0-9\-_.]+/gi,'_');
      a.href = URL.createObjectURL(blob);
      a.download = `${safeName || 'qr'}.png`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(a.href);
    }

    async function copyPNG() {
      try {
        const canvas = box.querySelector('canvas');
        if (!canvas || !navigator.clipboard || !window.ClipboardItem) return;
        const blob = await new Promise(res => canvas.toBlob(res, 'image/png'));
        await navigator.clipboard.write([new ClipboardItem({ 'image/png': blob })]);
        alert('QR image copied to clipboard.');
      } catch (e) {
        alert('Copy failed in this browser. Try downloading PNG instead.');
      }
    }

    function clearAll() {
      elText.value = '';
      box.innerHTML = '';
      status.textContent = '';
    }

    document.getElementById('btnGenerate').addEventListener('click', gen);
    document.getElementById('btnPng').addEventListener('click', downloadPNG);
    document.getElementById('btnCopy').addEventListener('click', copyPNG);
    document.getElementById('btnClear').addEventListener('click', clearAll);

    // Auto-generate initial example
    gen();
  </script>
</body>
</html>
